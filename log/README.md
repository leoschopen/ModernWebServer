# 高性能服务器日志系统

这是一个高性能服务器日志系统，它能够按照天数和最大行数自动切分日志，并支持异步写入。该日志系统的实现主要依赖于C++11标准库中的线程库和互斥量库。

## 功能
该日志系统具有以下功能：

> * 自动切分日志文件，按天、超行
> * 支持按照日志等级输出
> * 支持同步、异步写入

### 函数实现
```c++
    Log::Log // 构造函数，初始化日志系统
    Log::~Log // 析构函数，清理资源
    int Log::GetLevel() // 获取日志等级
    void Log::SetLevel(int level) // 设置日志等级
    void Log::init(int level, const char* file_name, int max_queue_size) // 初始化日志系统，包括创建日志文件，开启异步写入等
    void Log::AppendLogLevelTitle_(int level) // 在日志信息前加上日志等级标识
    void Log::write(int level, const char *format, ...) // 写入日志信息
    void Log::flush() // 刷新日志缓存，确保所有日志信息被写入日志文件
    void Log::AsyncWrite_() // 异步写入日志信息
    void Log::FlushLogThread() // 日志写入线程函数，用于异步写入日志信息
```


## 模块
> * 该日志系统主要包含以下模块：
> * buffer模块
> * 阻塞队列模块
> * 日志模块

## 技术点
该日志系统的实现使用了C++11标准库中的线程库和互斥量库，可以实现高效的异步写入。另外，该日志系统还实现了按照天数和最大行数自动切分日志文件的功能。

1. 异步的实现方式
该日志系统的异步写入是通过阻塞队列+线程实现的。当指定异步实现的时候，创建阻塞队列和写入线程，在write函数中，主线程不断将buffer内容加入阻塞队列，而写入线程不断从阻塞队列中取出内容写入文件。这样就实现了异步写入。这样的方式以减轻主线程的工作负担，提高程序的响应速度和效率。如果不使用多线程，每次写入日志都需要等待文件写入完成才能继续执行，可能会造成程序的阻塞。但是，在写入日志频率较低的情况下，使用多线程可能会造成额外的开销，反而会影响程序的性能。


## C++新特性
该日志系统的实现使用了C++11标准库中的线程库和互斥量库。

## 未来改进
考虑增加日志系统的灵活性，支持通过配置文件来控制日志的输出等级和输出路径。此外，还可以考虑引入更高效的日志写入算法，进一步提高日志系统的性能。
参考开源项目